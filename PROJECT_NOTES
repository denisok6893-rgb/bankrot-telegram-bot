## Контракт данных: v2 (добавлены реальные кейсы + пол клиента)
Версия: v1  
Дата фиксации: 21.12.2025  
Статус: актуально до проверки на реальных заявлениях

---

# 1. Назначение документа
Этот файл фиксирует ключевые решения, контракты данных и логику проекта.
Файл предназначен для:
- быстрого восстановления контекста проекта,
- работы с ИИ (ChatGPT / Codex / Cursor),
- предотвращения архитектурных ошибок и откатов.

Проект развивается с прицелом на коммерческое использование.

---

## 2. Суть проекта
Telegram-бот для помощи юристу по банкротству физических лиц (РФ).

Основная задача:
- автоматизация подготовки процессуальных документов
- на основе **карточки дела**
- строго по **DOCX-шаблонам**
- без генерации юридических решений или прогнозов.

Законодательная база:
- ФЗ №127 «О несостоятельности (банкротстве)»

---

## 3. Основной документ v1
На старте реализуется **один документ**:

**«Заявление о признании гражданина несостоятельным (банкротом)»**

Все последующие документы будут:
- использовать ту же карточку дела,
- наследовать логику блоков и проверок,
- расширяться без изменения базы данных.

---

## 4. Ключевые архитектурные принципы

### 4.1 Один источник истины
- Все данные берутся **только из карточки дела**
- Документы не формируются "в воздухе"
- Без выбранного дела — генерация запрещена

### 4.2 Только шаблоны
- Документы формируются **только по DOCX-шаблонам**
- Никакой генерации текста «с нуля»
- Только подстановка данных и динамические блоки

### 4.3 Управляемый ИИ
ИИ:
- проверяет полноту данных,
- формирует блоки,
- подсказывает, что не заполнено.

ИИ НЕ:
- принимает юридические решения,
- не интерпретирует закон,
- не добавляет факты от себя.

---

## 5. Правила по ФИО (жёстко зафиксировано)
- Полное ФИО должника указывается **только в шапке документа**
- Далее используется формат: **Фамилия И.О.**
- Это правило применяется во всех документах проекта

## 5.1 Учёт пола клиента (обязательное правило v2)
Документ должен корректно подставлять гендерные формы (м/ж) для:
- "зарегистрированный/зарегистрированная"
- "проживающий/проживающая"
- "имеющий/имеющая"
- "не зарегистрирован/не зарегистрирована"
- "несостоятельным/несостоятельной"
- местоимения "его/её" в устойчивых формулировках

В карточке дела хранится поле:
- `debtor_gender` = `male` | `female`

В коде формируется словарь производных форм, например:
- `debtor_registered_word`
- `debtor_living_word`
- `debtor_having_word`
- `debtor_not_registered_word`
- `debtor_insolvent_word`
- `debtor_pronoun_genitive`

---

## 6. Контракт данных v1 (общее)

### 6.1 Обязательные данные
Без этих данных документ не генерируется:
- Арбитражный суд
- ФИО должника
- Дата рождения
- Адрес
- Кредиторы (минимум 1)
- Общая сумма задолженности
- Пол клиента (male/female) — v2

### 6.2 Переменные блоки
Все нижеуказанные части формируются динамически:
- кредиторы
- семейное положение
- дети
- имущество
- транспорт
- приложения

Если данных нет — используется корректная формулировка «отсутствует».

### 6.3 Реальный кейс (v2): один кредитор = несколько обязательств
На практике у одного кредитора может быть несколько строк задолженности.
Структура хранения:

creditors[]:
- name
- ogrn
- inn
- address
- obligations[]:
  - amount_rubles
  - amount_kopeks
  - source
  - note

Блоки документа:
- creditors_header_block
- creditors_block

---

## 7. Семейное положение и дети (важно)
Семейное положение и дети **НЕ хранятся текстом**.

В карточке дела хранятся факты:
- marital_status
- spouse_full_name
- has_children
- has_minor_children
- children_count

На их основе формируется единый блок:
- `family_status_block`

ИИ не имеет права выдумывать данные о семье.

### 7.1 Реальный кейс (v2): реквизиты брака
Если marital_status = married, в карточке дела храним:
- marriage_certificate_number
- marriage_certificate_date

family_status_block должен уметь включать эти реквизиты.

---

## 8. Безопасность (минимальный уровень v1)
- Персональные данные не логируются
- Токены и ключи хранятся в `.env`
- `.env` исключён из репозитория
- Документы хранятся в закрытой директории
- В логах используется только `case_id`

---

## 9. Что проект сознательно НЕ делает
- Не даёт юридических консультаций
- Не прогнозирует решения суда
- Не формирует документы без данных
- Не заменяет юриста

---

## 10. Текущий статус
- README.md добавлен
- Контракт данных v1 зафиксирован
- Шаблон заявления v1 подготовлен
- Ожидаются реальные заполненные заявления от юриста

---

## 11. Следующие шаги
1. Получить 2–5 реальных заявлений от юриста
2. Сверить их с контрактом данных
3. При необходимости выпустить контракт данных v2
4. Подготовить промт для Codex
5. Реализовать генерацию документа в боте

---

## 12. Важное правило проекта
**Сначала структура и данные → потом код.**

Нарушение этого правила приводит к переделкам.
